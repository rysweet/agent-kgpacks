[
  {
    "id": "sc_001",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What is Microsoft Security Copilot primarily designed to do?",
    "ground_truth": "Microsoft Security Copilot is an AI-powered security analysis tool that combines large language models with security-specific plugins and skills to help security teams analyze threats, respond to incidents, and assess vulnerabilities.",
    "source": "core_definition"
  },
  {
    "id": "sc_002",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "Name two Microsoft security products that integrate with Security Copilot.",
    "ground_truth": "Microsoft Sentinel and Microsoft Defender for Endpoint are two key products that integrate with Security Copilot to provide threat intelligence and endpoint security data.",
    "source": "product_integration"
  },
  {
    "id": "sc_003",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What is a promptbook in Security Copilot?",
    "ground_truth": "A promptbook is a predefined collection of AI-generated prompts and workflows that guide users through common security tasks such as incident response and threat analysis.",
    "source": "promptbooks"
  },
  {
    "id": "sc_004",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What does KQL stand for in the context of Security Copilot?",
    "ground_truth": "KQL stands for Kusto Query Language, which is used to query and analyze security data in Microsoft Sentinel and other Microsoft security tools.",
    "source": "kql_queries"
  },
  {
    "id": "sc_005",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "How does Security Copilot enable natural language queries?",
    "ground_truth": "Security Copilot uses large language models to understand natural language input from users, converting plain English queries into technical security analysis without requiring users to know complex query syntax.",
    "source": "natural_language_queries"
  },
  {
    "id": "sc_006",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What is the MITRE ATT&CK framework used for in Security Copilot?",
    "ground_truth": "The MITRE ATT&CK framework is used to classify and understand adversary tactics, techniques, and procedures (TTPs) within Security Copilot's threat analysis and incident response workflows.",
    "source": "mitre_attack"
  },
  {
    "id": "sc_007",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What are custom plugins in Security Copilot?",
    "ground_truth": "Custom plugins are extensions that organizations can develop to integrate Security Copilot with their own security tools, data sources, and internal systems to extend its capabilities.",
    "source": "custom_plugins"
  },
  {
    "id": "sc_008",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "Name one vulnerability assessment capability provided by Security Copilot.",
    "ground_truth": "Security Copilot can analyze vulnerability data, prioritize vulnerabilities by risk and exploitability, and recommend remediation actions based on threat intelligence.",
    "source": "vulnerability_assessment"
  },
  {
    "id": "sc_009",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "How does Security Copilot assist in incident response workflows?",
    "ground_truth": "Security Copilot helps SOC teams by automating threat analysis, providing rapid incident context, suggesting investigation steps, and recommending containment and remediation actions.",
    "source": "incident_response"
  },
  {
    "id": "sc_010",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What role do security-specific plugins play in Security Copilot?",
    "ground_truth": "Security-specific plugins connect Security Copilot to threat intelligence feeds, endpoint data, identity information, and other security data sources to provide context-aware analysis.",
    "source": "plugins_skills"
  },
  {
    "id": "sc_011",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "Which Microsoft identity and access product integrates with Security Copilot for security analysis?",
    "ground_truth": "Microsoft Entra ID (formerly Azure AD) integrates with Security Copilot to provide identity security analysis, including user risk assessment and authentication pattern detection.",
    "source": "entra_id_security"
  },
  {
    "id": "sc_012",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What is the primary benefit of using Security Copilot in a SOC environment?",
    "ground_truth": "Security Copilot reduces mean time to detect (MTTD) and mean time to respond (MTTR) by automating analysis, providing rapid threat assessment, and enabling faster decision-making for security teams.",
    "source": "soc_workflows"
  },
  {
    "id": "sc_013",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "Can Security Copilot generate KQL queries automatically?",
    "ground_truth": "Yes, Security Copilot can generate KQL queries from natural language descriptions, allowing analysts to query Sentinel data without manually writing complex syntax.",
    "source": "kql_generation"
  },
  {
    "id": "sc_014",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What type of threat intelligence does Security Copilot help analyze?",
    "ground_truth": "Security Copilot analyzes threat intelligence including indicators of compromise (IOCs), malware signatures, adversary tactics, campaign information, and vulnerability exploit data.",
    "source": "threat_intelligence"
  },
  {
    "id": "sc_015",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "How does Security Copilot integrate with Microsoft Sentinel?",
    "ground_truth": "Security Copilot integrates with Sentinel as a built-in or connected tool that can query incident data, execute KQL queries, and provide AI-powered analysis recommendations within the Sentinel interface.",
    "source": "sentinel_integration"
  },
  {
    "id": "sc_016",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What information can Security Copilot extract from Defender for Endpoint data?",
    "ground_truth": "Security Copilot can analyze endpoint telemetry from Defender for Endpoint including process execution, file activities, network connections, and suspicious behavior to identify compromises.",
    "source": "defender_endpoint"
  },
  {
    "id": "sc_017",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What is a key advantage of Security Copilot's natural language interface over traditional query tools?",
    "ground_truth": "The natural language interface makes Security Copilot more accessible to analysts with varying technical expertise, reducing the learning curve for security investigations and queries.",
    "source": "natural_language_interface"
  },
  {
    "id": "sc_018",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "How do promptbooks improve SOC efficiency?",
    "ground_truth": "Promptbooks standardize investigation procedures, reduce manual work by guiding analysts through best practices, and ensure consistent response processes across the SOC team.",
    "source": "promptbook_efficiency"
  },
  {
    "id": "sc_019",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "What is the relationship between Security Copilot and the MITRE ATT&CK framework?",
    "ground_truth": "Security Copilot uses MITRE ATT&CK classifications to help analysts understand the tactics and techniques used by attackers, improving contextualization of threats during investigations.",
    "source": "mitre_contextualization"
  },
  {
    "id": "sc_020",
    "domain": "security_copilot",
    "difficulty": "easy",
    "question": "Can organizations create their own plugins for Security Copilot?",
    "ground_truth": "Yes, organizations can develop custom plugins to extend Security Copilot's functionality and integrate it with proprietary security tools, data platforms, and internal business systems.",
    "source": "extensibility"
  },
  {
    "id": "sc_021",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How does Security Copilot leverage the MITRE ATT&CK framework within its analysis, and what is the primary benefit of this integration?",
    "ground_truth": "Security Copilot maps detected threats and behaviors to MITRE ATT&CK tactics and techniques, enabling analysts to understand adversary TTPs (tactics, techniques, and procedures) and align response actions with the framework. This standardizes threat classification and facilitates better incident contextualization.",
    "source": "MITRE ATT&CK framework integration"
  },
  {
    "id": "sc_022",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Explain the difference between using natural language queries versus KQL queries in Security Copilot. What are the trade-offs?",
    "ground_truth": "Natural language queries are more intuitive and require no KQL syntax knowledge, making them accessible to non-technical analysts; KQL queries offer precision and control for complex investigations but require expertise. Natural language may sacrifice specificity, while KQL demands technical proficiency but provides exact filtering and data manipulation.",
    "source": "natural language queries vs KQL queries"
  },
  {
    "id": "sc_023",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "What role do security-specific plugins play in extending Security Copilot's capabilities, and how do they differ from general LLM plugins?",
    "ground_truth": "Security-specific plugins are tailored to integrate with Microsoft security products (Sentinel, Defender, Entra ID) and threat intelligence sources, providing domain-specific context and APIs. Unlike general LLM plugins, they embed security logic, enable automated queries against security data sources, and maintain compliance with security frameworks.",
    "source": "security-specific plugins and skills"
  },
  {
    "id": "sc_024",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How does Microsoft Sentinel integration enable Security Copilot to enhance incident response workflows, and what specific data does it access?",
    "ground_truth": "Security Copilot connects to Sentinel to access raw logs, alerts, investigation data, and threat intelligence tables via KQL queries. This allows analysts to retrieve contextual evidence, perform threat hunting, and correlate multi-source data within a conversational interface, accelerating investigation timelines.",
    "source": "Microsoft Sentinel integration"
  },
  {
    "id": "sc_025",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Describe how promptbooks function within Security Copilot and explain their value in a SOC environment.",
    "ground_truth": "Promptbooks are pre-built, repeatable prompt sequences that automate complex investigation workflows. They standardize incident response procedures, reduce analyst time-to-answer, and ensure consistency by encoding best practices into reusable templates that can be tailored for specific incident types or organizational procedures.",
    "source": "promptbooks"
  },
  {
    "id": "sc_026",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "What capabilities does Defender for Endpoint provide to Security Copilot, and how does this integration improve endpoint threat analysis?",
    "ground_truth": "Defender for Endpoint exposes endpoint telemetry, device alerts, file/process execution data, and behavioral threat indicators to Security Copilot. This enables analysts to pivot from network-level events to endpoint evidence, correlate behavioral signals across devices, and make informed containment decisions.",
    "source": "Defender for Endpoint integration"
  },
  {
    "id": "sc_027",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Explain the relationship between threat intelligence, plugins, and incident enrichment in Security Copilot. How do they work together?",
    "ground_truth": "Threat intelligence plugins automatically enrich incidents by correlating observed indicators (IPs, domains, file hashes) against threat feeds. Plugins retrieve reputation data, malware classifications, and campaign information, which Security Copilot contextualizes within the incident narrative to accelerate triage and determine severity.",
    "source": "threat intelligence and plugins"
  },
  {
    "id": "sc_028",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How can custom plugins extend Security Copilot functionality beyond Microsoft products, and what considerations are necessary when building them?",
    "ground_truth": "Custom plugins integrate third-party security tools (SIEM, ticketing systems, external threat feeds) via APIs or webhooks. Developers must ensure proper authentication, handle rate limits, structure responses for NLP comprehension, and maintain security by validating inputs and protecting credentials.",
    "source": "custom plugins development"
  },
  {
    "id": "sc_029",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "What is the significance of Entra ID security integration with Security Copilot, and what identity-related investigations can it enable?",
    "ground_truth": "Entra ID integration exposes sign-in logs, risky users, conditional access triggers, and identity protection signals. This enables analysts to investigate suspicious authentication patterns, correlate identity-based attacks with lateral movement, and assess identity compromise risk during incident response.",
    "source": "Entra ID security"
  },
  {
    "id": "sc_030",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Describe how Security Copilot handles multi-step incident investigations and explain the advantage over traditional manual query-based approaches.",
    "ground_truth": "Security Copilot maintains conversational context across multiple turns, allowing analysts to ask follow-up questions without re-specifying context. It chains logic across queries, correlates results, and suggests next investigative steps\u2014reducing context-switching overhead and enabling faster hypothesis validation compared to sequential manual KQL queries.",
    "source": "incident response workflows"
  },
  {
    "id": "sc_031",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How does Security Copilot balance automation with analyst expertise, and what types of decisions should remain human-driven?",
    "ground_truth": "Security Copilot automates data retrieval, correlation, and initial analysis recommendations, but analysts must validate findings, assess business context, and approve containment actions. Critical decisions\u2014incident classification, escalation, and response execution\u2014require human judgment to account for organizational risk tolerance and operational impact.",
    "source": "SOC workflows and human-in-the-loop"
  },
  {
    "id": "sc_032",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Explain how Security Copilot constructs its threat intelligence insights. What data sources can it access, and how are they prioritized?",
    "ground_truth": "Security Copilot aggregates threat intelligence from Microsoft's internal telemetry, Sentinel threat intelligence tables, and integrated third-party feeds. Insights are prioritized by source reputation, recency, and relevance to the detected threat; Microsoft's cross-tenant data provides scale while external feeds add specialized threat context.",
    "source": "threat intelligence sources"
  },
  {
    "id": "sc_033",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "What challenges does Security Copilot address in vulnerability assessment, and how does its approach differ from traditional scanning tools?",
    "ground_truth": "Security Copilot contextualizes vulnerability scan results with threat intelligence, exploit availability, and environmental factors rather than listing vulnerabilities in isolation. It prioritizes remediations based on business risk, active exploits, and compensating controls\u2014enabling smarter patching decisions than raw CVSS scores alone.",
    "source": "vulnerability assessment"
  },
  {
    "id": "sc_034",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How does Security Copilot assist in KQL query optimization, and what is the benefit of this capability for SOC analysts?",
    "ground_truth": "Security Copilot can generate, explain, and optimize KQL queries based on natural language requests or by analyzing performance of existing queries. This reduces query-writing overhead, teaches analysts KQL syntax, and ensures efficient data retrieval\u2014important for resource-constrained SOCs handling high-volume alerts.",
    "source": "KQL query assistance"
  },
  {
    "id": "sc_035",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Describe the typical incident response workflow in Security Copilot from detection to containment recommendation. What stages benefit most from AI assistance?",
    "ground_truth": "Detection triggers an alert; analysts triage using natural language queries to assess scope and impact. Enrichment via threat intelligence and plugins establishes TTPs. Copilot suggests investigation paths using MITRE ATT&CK context and prior cases. Containment recommendations are AI-guided but require analyst approval. Detection, enrichment, and investigation stages gain the most efficiency gain.",
    "source": "incident response workflow"
  },
  {
    "id": "sc_036",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "What governance and access control considerations are necessary when deploying Security Copilot in a multi-tenant SOC environment?",
    "ground_truth": "Role-based access controls must restrict analysts to their tenant's data, prompt history must be audited and potentially retained for compliance, and sensitive queries should be logged. Organizations must establish policies on data retention, external plugin access, and approval workflows for custom prompt creation to prevent data leakage across tenants.",
    "source": "SOC governance and security"
  },
  {
    "id": "sc_037",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How can Security Copilot be used to improve threat hunting proactively, and what role do promptbooks play in this process?",
    "ground_truth": "Analysts use Security Copilot to develop hypotheses based on MITRE ATT&CK techniques and emerging threats, then execute structured hunts via promptbooks. Promptbooks encode hunting patterns (e.g., detecting living-off-the-land techniques) that can be run repeatedly, reducing time-to-detection for known adversary TTPs and enabling consistent methodology across hunters.",
    "source": "threat hunting with promptbooks"
  },
  {
    "id": "sc_038",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "Explain the limitations of natural language processing in Security Copilot and when analysts should default to explicit KQL or API calls.",
    "ground_truth": "Natural language NLP may struggle with ambiguous queries, edge-case logic (complex boolean operations), or datasets requiring exact filters that human language cannot precisely express. For high-stakes investigations requiring absolute accuracy, compliance-mandated exact queries, or performance-critical searches over massive datasets, explicit KQL provides necessary precision and auditability.",
    "source": "natural language limitations"
  },
  {
    "id": "sc_039",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "How does Security Copilot integrate threat intelligence with the MITRE ATT&CK framework to provide context during incident analysis?",
    "ground_truth": "When analyzing an incident, Security Copilot maps observed behaviors to MITRE ATT&CK techniques and correlates them with threat intelligence linking those techniques to known threat actors and campaigns. This provides immediate context about adversary intent, typical targets, and historical response patterns\u2014significantly accelerating analyst understanding.",
    "source": "threat intelligence and MITRE ATT&CK correlation"
  },
  {
    "id": "sc_040",
    "domain": "security_copilot",
    "difficulty": "medium",
    "question": "What strategies should SOCs employ to ensure Security Copilot recommendations are validated and trustworthy before acting on them?",
    "ground_truth": "SOCs should implement validation workflows requiring analysts to review underlying evidence before executing recommendations, establish confidence thresholds for auto-actioning low-risk tasks, conduct post-incident reviews to assess Copilot recommendation accuracy, and regularly audit prompts for bias. Training analysts on AI limitations and requiring multi-analyst review for critical actions mitigates risks.",
    "source": "validation and trust in AI recommendations"
  },
  {
    "id": "sc_041",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "When integrating Security Copilot with Microsoft Sentinel, what are the performance implications of using natural language queries versus native KQL queries at scale, and how should a SOC architect mitigate potential latency issues during high-volume incident investigations?",
    "ground_truth": "Natural language queries incur additional LLM processing overhead to translate to KQL, introducing 200-500ms latency compared to direct KQL execution. For high-volume SOC operations, architect hybrid approaches: use natural language for discovery and threat hunting, pre-compile critical queries as KQL in promptbooks, and leverage custom plugins for frequently-used investigation patterns. Implement query result caching and batch processing through automation rules to reduce repetitive LLM invocations.",
    "source": "sentinel_integration_performance"
  },
  {
    "id": "sc_042",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "How should you design a custom plugin for Security Copilot that enriches MITRE ATT&CK technique detections with threat intelligence, and what security considerations must you implement to prevent prompt injection attacks through malicious threat intel feeds?",
    "ground_truth": "Design custom plugins with input validation layers that sanitize threat intelligence data before passing to LLM context; implement allowlisting of trusted threat intel sources and schema validation for all external data. Use parametrized plugin calls rather than direct string concatenation. Apply principle of least privilege to plugin API credentials, implement rate limiting, and maintain audit logs of all plugin invocations. Isolate plugin execution in sandboxed environments and version-control plugin code changes.",
    "source": "custom_plugins_security"
  },
  {
    "id": "sc_043",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "In a multi-tenant environment using Security Copilot, how would you configure Entra ID security controls to ensure that SOC analysts from different customer organizations cannot access each other's threat data or investigation context, and what are the architectural limitations?",
    "ground_truth": "Implement Entra ID conditional access policies with tenant-level isolation using resource-based access control (RBAC) tied to custom security attributes. Configure Copilot promptbooks to include tenant filtering logic in all KQL queries and restrict plugin access through Entra ID service principals scoped per tenant. Key limitation: the underlying LLM model processes queries in shared infrastructure, so implement data residency controls at the Copilot API gateway and ensure all context window data is purged between tenant requests to prevent cross-tenant inference.",
    "source": "entra_id_multi_tenancy"
  },
  {
    "id": "sc_044",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "When Defender for Endpoint alert telemetry feeds into Security Copilot, describe the edge case where false positives in behavioral detection generate large volumes of natural language queries. How would you structure a promptbook to prevent alert fatigue and maintain investigation fidelity?",
    "ground_truth": "Implement promptbook logic that first deduplicates alerts based on device ID, process hash, and temporal clustering (group alerts within 5-minute windows). Use a two-stage filtering: stage 1 applies machine learning confidence thresholds from Defender (only > 85% confidence), stage 2 leverages Copilot to correlate against known software behavioral baselines. Create a feedback loop where analyst-marked false positives retrain alert tuning rules. Include MITRE ATT&CK tactic filters to focus on high-severity techniques and reference threat intelligence to contextualize alerts before human review.",
    "source": "defender_endpoint_alert_handling"
  },
  {
    "id": "sc_045",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "How does Security Copilot's KQL query generation from natural language handle complex time-series correlation across multiple Sentinel tables, and what optimizations should be applied when investigating a suspected lateral movement campaign spanning 30 days across 5,000+ devices?",
    "ground_truth": "Copilot generates KQL using join operators and time-window functions, but multi-table correlations over extended timeframes risk timeout (>30 min queries) or prohibitive resource consumption. Optimize by: (1) pre-aggregating device-to-device connection data into a custom table, (2) partitioning queries by 7-day windows with union operations, (3) using materialized views for common lateral movement indicators, (4) implementing custom plugins that invoke stored procedures for complex joins. Request explicit timeframe constraints in natural language prompts and design promptbooks that incrementally narrow investigation scope based on initial results.",
    "source": "kql_optimization_timeseries"
  },
  {
    "id": "sc_046",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "Describe a scenario where Security Copilot misinterprets a natural language incident response query due to ambiguous terminology, and explain how you would correct the LLM behavior through promptbook engineering and few-shot examples without modifying the core model.",
    "ground_truth": "Example: query 'find all privilege escalation' is ambiguous\u2014does it mean Entra ID role elevation, process privilege escalation, or network permission changes? Address through: (1) Add clarifying system instructions in promptbook preambles defining organizational terminology (e.g., 'privilege escalation = UAC bypass or token impersonation in Windows environment'), (2) Include 3-5 few-shot examples showing correctly-mapped queries to MITRE ATT&CK tactics (T1134, T1548), (3) Add validation steps that require Copilot to state assumptions before generating KQL, (4) Map ambiguous terms to custom lookup tables. Test iteratively with analyst feedback to refine context.",
    "source": "promptbook_nlp_disambiguation"
  },
  {
    "id": "sc_047",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "When Security Copilot generates a KQL query for threat hunting based on MITRE ATT&CK framework tactics, what are the risks of over-generalization, and how would you implement MITRE ATT&CK-specific constraints to reduce false positives while maintaining detection coverage?",
    "ground_truth": "Over-generalization risk: a query mapping to ATT&CK T1056 (Observation) could match thousands of harmless monitoring tools. Mitigate by: (1) Require specific sub-technique mapping (e.g., T1056.004 Webcam Capture) in Copilot prompts, (2) Create MITRE ATT&CK filters that exclude whitelisted software (e.g., legitimate RDP tools for T1021.001), (3) Combine with threat actor profile from threat intelligence plugins, (4) Implement behavioral baseline thresholds (e.g., alert only if process spawns 10+ child processes, not just one). Use promptbooks that mandate technique+sub-technique+actor context before KQL generation.",
    "source": "mitre_attack_query_precision"
  },
  {
    "id": "sc_048",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "In a Security Copilot deployment, how would you implement a custom plugin that correlates Entra ID authentication anomalies with Defender for Endpoint behavioral alerts to detect compromised service accounts, and what data isolation requirements must be met?",
    "ground_truth": "Design a correlation plugin that ingests Entra ID Sign-in Risk events (impossible travel, atypical locations) and cross-references against Defender alerts on the same service account within a 15-minute window. Use service principal object ID as the correlation key, not username (which can be spoofed). Implement data isolation by: (1) restricting plugin API permissions to read-only on both Entra ID and Defender, (2) filtering results to only service accounts in a defined security group, (3) excluding authentication events tagged as 'automation' or 'service health checks', (4) implementing PII masking on sign-in IP addresses in output. Use managed identity authentication and log all plugin invocations to an immutable audit table.",
    "source": "cross_product_correlation_plugin"
  },
  {
    "id": "sc_049",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "How should threat intelligence be operationalized within Security Copilot plugins to maximize incident response speed without introducing poisoned intelligence, and what are the architectural tradeoffs between real-time threat feeds versus periodic intelligence enrichment?",
    "ground_truth": "Real-time feeds enable immediate correlation but risk propagating false intelligence during 0-day reporting windows; implement validation: cross-reference IoCs against 3+ independent sources before alerting. Use real-time feeds for known-bad indicators (malware hashes, confirmed C2 IPs), periodic enrichment (4-hour cycles) for reputation data and actor attribution. Architect with threat intelligence plugins that: (1) validate source trustworthiness using STIX confidence scores, (2) implement rollback mechanisms if intelligence is retracted, (3) apply temporal decay to older intelligence relevance, (4) cache enriched results to reduce query latency. Design promptbooks that distinguish between high-confidence (directly observed) and inferred intelligence to guide analyst response actions.",
    "source": "threat_intelligence_operationalization"
  },
  {
    "id": "sc_050",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "Describe how to troubleshoot a scenario where a Security Copilot incident response promptbook that worked correctly in staging fails intermittently in production, generating incorrect KQL syntax when accessing Sentinel tables that contain special characters or reserved keywords.",
    "ground_truth": "Root cause: LLM tokenization varies based on context window state and model temperature; reserved keywords in table/column names (e.g., 'order', 'select') cause KQL generation errors. Troubleshoot by: (1) Enable Copilot diagnostic logging to capture exact prompts and LLM responses, (2) Add explicit KQL escaping rules in promptbook system instructions using bracket notation `[TableName]`, (3) Pre-validate table schema and inject column name mappings into context, (4) Reduce model temperature (0.2-0.4) in production for deterministic output, (5) Implement query validation via dry-run execution before analyst display. Add staging-to-production parity checks: test promptbooks against production Sentinel schema, not mock data.",
    "source": "promptbook_troubleshooting_production"
  },
  {
    "id": "sc_051",
    "domain": "security_copilot",
    "difficulty": "hard",
    "question": "When designing a Security Copilot vulnerability assessment workflow integrated with Defender for Vulnerability Management, what are the key challenges in prioritizing remediation across thousands of CVEs, and how would you engineer a custom plugin to align vulnerability risk with MITRE ATT&CK exploitation chains?",
    "ground_truth": "Challenge: raw CVSS scores don't reflect organizational risk; a low-CVSS CVE exploitable by prevalent malware poses higher risk than high-CVSS unexercised vulnerabilities. Engineer a plugin that: (1) maps CVEs to MITRE ATT&CK techniques using threat intelligence (e.g., CVE-2024-X exploits T1190 Exploit Public-Facing Application), (2) weights prioritization by: asset criticality (Entra ID-integrated systems first), threat actor activity (correlate with recent APT campaigns), environmental exposure (internet-facing vs. internal), (3) queries Sentinel for historical exploitation attempts, (4) cross-reference against active exploit code availability in threat feeds. Output a risk matrix: (technique prevalence \u00d7 asset criticality \u00d7 exploit availability) to guide patch sequencing, not CVSS alone.",
    "source": "vulnerability_assessment_mitre_alignment"
  }
]
